<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>The Equals</title>
    <style>
        /* === TEMEL STİLLER === */
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');

        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Roboto Mono', 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden; /* Sadece yatay scroll'u engelle */
            padding: 10px; /* Mobil için kenar boşluğu */
        }

        /* Ana oyun konteyneri */
        #game-container {
            width: 95%;
            max-width: 800px;
            padding: 20px;
            border: 1px solid #333;
            background-color: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 2;
            border-radius: 10px; /* Mobil için yuvarlatılmış köşeler */
        }

        /* Mobil optimizasyonları */
        @media (max-width: 768px) {
            body {
                padding: 5px;
                font-size: 14px;
                min-height: 100vh;
                align-items: flex-start;
                padding-top: 20px;
            }
            
            #game-container {
                width: 98%;
                padding: 15px;
                margin: 0;
                max-height: 90vh;
                overflow-y: auto;
            }
            
            #story-text {
                font-size: 1em;
                line-height: 1.6;
                margin-bottom: 20px;
                word-wrap: break-word;
            }
            
            .choice-button {
                padding: 12px 15px;
                font-size: 0.9em;
                margin-bottom: 8px;
                word-wrap: break-word;
                white-space: normal;
                min-height: 44px; /* Touch target için */
            }
            
            #logo-container {
                margin-bottom: 20px;
            }
            
            #game-logo {
                width: 60px;
                height: 60px;
            }

            #choices {
                gap: 10px;
            }
        }

        /* Çok küçük ekranlar için */
        @media (max-width: 480px) {
            body {
                font-size: 13px;
                padding: 3px;
                padding-top: 15px;
            }
            
            #game-container {
                padding: 10px;
                width: 99%;
                max-height: 95vh;
            }
            
            #story-text {
                font-size: 0.9em;
                line-height: 1.5;
                margin-bottom: 15px;
            }
            
            .choice-button {
                padding: 10px 12px;
                font-size: 0.85em;
                min-height: 40px;
                margin-bottom: 6px;
            }
            
            #game-logo {
                width: 50px;
                height: 50px;
            }

            #choices {
                gap: 8px;
            }
        }

        /* Landscape modu için */
        @media (max-height: 500px) and (orientation: landscape) {
            body {
                padding: 2px;
                align-items: flex-start;
                padding-top: 5px;
            }
            
            #game-container {
                max-height: 98vh;
                padding: 8px;
            }
            
            #story-text {
                font-size: 0.85em;
                line-height: 1.4;
                margin-bottom: 10px;
            }
            
            .choice-button {
                padding: 8px 12px;
                font-size: 0.8em;
                min-height: 32px;
                margin-bottom: 4px;
            }
            
            #logo-container {
                margin-bottom: 10px;
                padding: 5px 0;
            }
            
            #game-logo {
                width: 40px;
                height: 40px;
            }
        }

        /* Çok küçük telefonlar için */
        @media (max-width: 360px) {
            body {
                font-size: 12px;
                padding: 2px;
            }
            
            #game-container {
                padding: 8px;
                width: 100%;
            }
            
            #story-text {
                font-size: 0.85em;
                line-height: 1.4;
                margin-bottom: 12px;
            }
            
            .choice-button {
                padding: 8px 10px;
                font-size: 0.8em;
                min-height: 36px;
                margin-bottom: 5px;
            }
            
            #game-logo {
                width: 40px;
                height: 40px;
            }

            #logo-container {
                margin-bottom: 15px;
                padding: 10px 0;
            }
        }

        /* Arka plan sistemi */
        body {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            transition: background-image 1s ease-in-out;
        }

        /* Arka plan overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1;
        }

        /* Oyun metninin alanı */
        #story-text {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 30px;
            white-space: pre-wrap; /* Satır başlarını koru */
        }

        /* Seçeneklerin (butonların) alanı */
        #choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Logo Konteyneri */
        #logo-container {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        /* Logo Stili */
        #game-logo {
            width: 80px;
            height: 80px;
            filter: invert(1) brightness(0.8); /* Beyaz yap ve hafif karart */
            transition: all 0.3s ease;
        }

        #game-logo:hover {
            filter: invert(1) brightness(1);
            transform: scale(1.1);
        }

        /* Seçenek butonları */
        .choice-button {
            background-color: transparent;
            color: #c94a4a; /* Devrimci Kırmızısı */
            border: 1px solid #c94a4a;
            padding: 15px 20px;
            font-family: inherit;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s ease;
            min-height: 44px; /* Touch target için minimum yükseklik */
            touch-action: manipulation; /* Mobil için touch optimizasyonu */
            -webkit-tap-highlight-color: transparent; /* iOS tap highlight'ı kaldır */
            position: relative;
            overflow: hidden;
        }

        .choice-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(201, 74, 74, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .choice-button:hover::before {
            left: 100%;
        }

        .choice-button:hover {
            background-color: #c94a4a;
            color: #121212;
            transform: translateX(10px) scale(1.02); /* Hafif sağa kayma ve büyüme efekti */
            box-shadow: 0 5px 15px rgba(201, 74, 74, 0.3);
        }

        .choice-button:active {
            transform: translateX(10px) scale(0.98);
        }

        /* Mobil için touch hedefleri */
        @media (max-width: 768px) {
            .choice-button {
                touch-action: manipulation;
                -webkit-tap-highlight-color: rgba(201, 74, 74, 0.3);
                user-select: none;
                -webkit-user-select: none;
            }
            
            .choice-button:active {
                background-color: #c94a4a;
                color: #121212;
                transform: scale(0.98);
            }
        }
        
        /* === YENİ GELİŞMİŞ PANELLER === */
        
        /* Liderin Panosu - Stilize edilmiş stat paneli */
        #leader-board {
            position: fixed;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(26,26,26,0.95));
            border: 2px solid #c94a4a;
            padding: 15px;
            font-size: 0.85em;
            border-radius: 10px;
            max-width: 250px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(201, 74, 74, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        #leader-board:hover {
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(201, 74, 74, 0.5);
        }
        
        .stat-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
        }
        
        .stat-icon {
            width: 20px;
            height: 20px;
            filter: invert(1);
            opacity: 0.8;
        }
        
        .stat-label {
            font-size: 0.75em;
            font-weight: 500;
            color: #ccc;
            min-width: 60px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-bar {
            flex: 1;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .stat-fill {
            height: 100%;
            transition: all 0.5s ease;
            border-radius: 4px;
        }
        
        .stat-fill.power { background: linear-gradient(90deg, #ff6b6b, #ee5a24); }
        .stat-fill.justice { background: linear-gradient(90deg, #74b9ff, #0984e3); }
        .stat-fill.support { background: linear-gradient(90deg, #00b894, #00a085); }
        .stat-fill.satisfaction { background: linear-gradient(90deg, #fdcb6e, #e17055); }
        .stat-fill.rebellion { background: linear-gradient(90deg, #e17055, #d63031); }
        .stat-fill.treasury { background: linear-gradient(90deg, #fdcb6e, #e17055); }
        .stat-fill.conscience { background: linear-gradient(90deg, #6c5ce7, #a29bfe); }
        
        .stat-value {
            min-width: 30px;
            text-align: right;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        /* İlişkiler Paneli */
        #relationships-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(26,26,26,0.95));
            border: 2px solid #74b9ff;
            padding: 15px;
            border-radius: 10px;
            max-width: 200px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(116, 185, 255, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            transform: translateX(-100%);
        }
        
        #relationships-panel.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .character-card {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
        }
        
        .character-name {
            font-weight: bold;
            color: #74b9ff;
            margin-bottom: 3px;
        }
        
        .character-status {
            font-size: 0.8em;
            opacity: 0.8;
        }
        
        .status-loyal { color: #00b894; }
        .status-angry { color: #e17055; }
        .status-enemy { color: #d63031; }
        .status-safe { color: #00b894; }
        .status-prison { color: #e17055; }
        .status-exile { color: #fdcb6e; }
        
        /* Görsel Geribildirim Efektleri */
        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .screen-flash.rebellion {
            background: radial-gradient(circle, rgba(214, 48, 49, 0.3) 0%, transparent 70%);
        }
        
        .screen-flash.positive {
            background: radial-gradient(circle, rgba(0, 184, 148, 0.2) 0%, transparent 70%);
        }
        
        /* Gazete Manşeti */
        #newspaper {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: #212529;
            padding: 20px;
            border-radius: 10px;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            z-index: 10000;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: all 0.5s ease;
        }
        
        #newspaper.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .newspaper-header {
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #c94a4a;
        }
        
        .newspaper-title {
            font-family: 'Times New Roman', serif;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
            line-height: 1.3;
        }
        
        .newspaper-date {
            text-align: center;
            font-size: 0.9em;
            opacity: 0.7;
            margin-bottom: 10px;
        }
        
        /* Lore Tooltip */
        .lore-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.8em;
            max-width: 200px;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .lore-tooltip.show {
            opacity: 1;
        }
        
        /* Koşullu Seçenekler */
        .choice-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #666;
            color: #666;
        }
        
        .choice-button.disabled:hover {
            background-color: transparent;
            color: #666;
            transform: none;
        }
        
        .requirement-text {
            font-size: 0.8em;
            opacity: 0.7;
            font-style: italic;
            margin-top: 5px;
        }
        
        /* Rastgele Olaylar */
        .random-event {
            background: linear-gradient(135deg, rgba(201, 74, 74, 0.1), rgba(116, 185, 255, 0.1));
            border-left: 4px solid #c94a4a;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .event-title {
            font-weight: bold;
            color: #c94a4a;
            margin-bottom: 8px;
        }
        
        /* Mobil için yeni paneller */
        @media (max-width: 768px) {
            #leader-board {
                top: 5px;
                right: 5px;
                padding: 10px;
                font-size: 0.7em;
                max-width: 180px;
            }
            
            .stat-label {
                font-size: 0.65em;
                min-width: 45px;
            }
            
            #relationships-panel {
                top: 5px;
                left: 5px;
                padding: 10px;
                max-width: 150px;
            }
            
            .stat-icon {
                width: 16px;
                height: 16px;
            }
            
            .stat-bar {
                height: 6px;
            }
            
            #newspaper {
                max-width: 90%;
                padding: 15px;
            }
        }
        
        /* Debug panel (eski) - gizli */
        #debug-panel {
            display: none;
        }
    </style>
</head>
<body>
    
    <div id="game-container">
        <div id="logo-container">
            <img src="logo.png" alt="The Equals Logo" id="game-logo">
        </div>
        <div id="story-text"></div>
        <div id="choices"></div>
    </div>

    <!-- Liderin Panosu -->
    <div id="leader-board">
        <div style="text-align: center; margin-bottom: 10px; font-weight: bold; color: #c94a4a;">LİDERİN PANOSU</div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972543.png" class="stat-icon" alt="Güç">
            <div class="stat-label">GÜÇ</div>
            <div class="stat-bar">
                <div class="stat-fill power" id="power-fill"></div>
            </div>
            <div class="stat-value" id="power-value">0</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972544.png" class="stat-icon" alt="Adalet">
            <div class="stat-label">ADALET</div>
            <div class="stat-bar">
                <div class="stat-fill justice" id="justice-fill"></div>
            </div>
            <div class="stat-value" id="justice-value">0</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972545.png" class="stat-icon" alt="Halk Desteği">
            <div class="stat-label">DESTEK</div>
            <div class="stat-bar">
                <div class="stat-fill support" id="support-fill"></div>
            </div>
            <div class="stat-value" id="support-value">0</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972546.png" class="stat-icon" alt="Memnuniyet">
            <div class="stat-label">MEMNUN</div>
            <div class="stat-bar">
                <div class="stat-fill satisfaction" id="satisfaction-fill"></div>
            </div>
            <div class="stat-value" id="satisfaction-value">0</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972547.png" class="stat-icon" alt="İsyan Riski">
            <div class="stat-label">İSYAN</div>
            <div class="stat-bar">
                <div class="stat-fill rebellion" id="rebellion-fill"></div>
            </div>
            <div class="stat-value" id="rebellion-value">0</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972548.png" class="stat-icon" alt="Hazine">
            <div class="stat-label">HAZİNE</div>
            <div class="stat-bar">
                <div class="stat-fill treasury" id="treasury-fill"></div>
            </div>
            <div class="stat-value" id="treasury-value">100</div>
        </div>
        <div class="stat-row">
            <img src="https://cdn-icons-png.flaticon.com/512/2972/2972549.png" class="stat-icon" alt="Vicdan">
            <div class="stat-label">VİCDAN</div>
            <div class="stat-bar">
                <div class="stat-fill conscience" id="conscience-fill"></div>
            </div>
            <div class="stat-value" id="conscience-value">0</div>
        </div>
    </div>

    <!-- İlişkiler Paneli -->
    <div id="relationships-panel">
        <div style="text-align: center; margin-bottom: 10px; font-weight: bold; color: #74b9ff;">İLİŞKİLER</div>
        <div id="relationships-content"></div>
    </div>

    <!-- Kontrol Paneli -->
    <div id="control-panel" style="position: fixed; bottom: 20px; left: 20px; z-index: 999; display: flex; gap: 10px;">
        <button id="save-button" style="background: rgba(0, 184, 148, 0.8); border: none; color: white; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: bold;">💾 Kaydet</button>
        <button id="load-button" style="background: rgba(116, 185, 255, 0.8); border: none; color: white; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: bold;">📂 Yükle</button>
        <button id="reset-button" style="background: rgba(230, 126, 34, 0.8); border: none; color: white; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: bold;">🔄 Sıfırla</button>
    </div>

    <!-- İlişkiler Butonu -->
    <button id="relationships-toggle" style="position: fixed; top: 10px; left: 10px; z-index: 999; background: rgba(116, 185, 255, 0.8); border: none; color: white; padding: 8px; border-radius: 5px; cursor: pointer;">👥</button>

    <!-- Görsel Efektler -->
    <div class="screen-flash" id="screen-flash"></div>

    <!-- Gazete Manşeti -->
    <div id="newspaper">
        <div class="newspaper-header">THE EQUALS GAZETESİ</div>
        <div class="newspaper-date" id="newspaper-date"></div>
        <div class="newspaper-title" id="newspaper-title"></div>
        <button onclick="closeNewspaper()" style="width: 100%; padding: 10px; background: #c94a4a; color: white; border: none; border-radius: 5px; cursor: pointer;">OKU</button>
    </div>

    <!-- Lore Tooltip -->
    <div class="lore-tooltip" id="lore-tooltip"></div>

    <!-- Debug panel (eski) -->
    <div id="debug-panel">
        <strong>DEBUG PANEL</strong><br>
        <span id="debug-info"></span>
    </div>

    <audio id="ambience-sound" src="https://www.myinstants.com/media/sounds/ambience-sci-fi-scary-dark-sound-effect-for-background-free-download.mp3" loop volume="0.2"></audio>

    <!-- HTML'e ekle -->
    <div id="skip-typewriter" style="display:none; position: fixed; bottom: 20px; right: 20px; z-index: 2000; background: #c94a4a; color: white; border: none; border-radius: 6px; padding: 10px 18px; font-weight: bold; font-size: 1em; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">Atla</div>

    <script>
        // === OYUN MOTORU VE VERİLER ===

        // Oyunun değişkenlerini tutan obje
        const gameState = {
            perde: 1,
            bolum: 1,
            adalet_puani: 0,
            guc_puani: 0,
            halk_destegi: 0,
            halk_memnuniyeti: 0,
            isyan_riski: 0,
            hazine: 100,
            karakter_adi: "",
            secilen_yol: "", // Propaganda/Sabotaj yolu
            müttefik: "", // Öğrenci/Sendika/Entelektüel
            yoldas_durumu: "", // Eski yoldaşın durumu
            secilen_strateji: "", // Barışçıl/Şiddetli/Karma
            elit_cevabi: "", // Elitlerin tepkisi
            devrim_tipi: "", // Kanlı/Barışçıl/Müzakere
            yonetim_stili: "", // Demokratik/Otoriter/Pragmatik
            muhalefet_durumu: "", // Bastırıldı/Entegre edildi/Dinlendi
            son_catisma_secimi: "", // Son karar
            
            // YENİ DEĞİŞKENLER
            kisisel_vicdan: 0, // Kişisel ahlaki durum
            dis_politika_durumu: "tarafsız", // Dış politika durumu
            teknoloji_seviyesi: 5, // Teknoloji seviyesi
            anahtar_karakterler: {
                elif: { durum: 'güvende', iliski: 'sadık' },
                eski_yoldas: { durum: 'hayatta', iliski: 'sadık' },
                aile_uyesi: { durum: 'tehlikede', iliski: 'kırgın' }
            },
            orgut_yapisi: "", // Merkeziyetçi/Yatay
            zertan_tehdidi: 0, // Dış tehdit seviyesi
            
            // YENİ GELİŞMİŞ DEĞİŞKENLER
            oyun_gunu: 1, // Oyun içi gün sayısı
            rastgele_olaylar: [], // Rastgele olaylar listesi
            gecikmeli_sonuclar: [], // Gecikmeli sonuçlar
            projeler: [], // Aktif projeler
            gazete_manseetleri: [] // Gazete manşetleri
        };

        // DOM elementlerini seçme
        const storyTextElement = document.getElementById('story-text');
        const choicesElement = document.getElementById('choices');
        const ambienceSound = document.getElementById('ambience-sound');
        const debugInfoElement = document.getElementById('debug-info');
        
        let isSoundStarted = false;

        // Metni harf harf yazma efekti
        let typewriterSkip = false;
        function typeWriter(text, onComplete) {
            let i = 0;
            storyTextElement.innerHTML = '';
            typewriterSkip = false;
            // Atla butonunu göster
            const skipBtn = document.getElementById('skip-typewriter');
            skipBtn.style.display = 'block';
            skipBtn.onclick = function() {
                typewriterSkip = true;
            };
            function type() {
                if (typewriterSkip) {
                    storyTextElement.innerHTML = text;
                    skipBtn.style.display = 'none';
                    if (onComplete) onComplete();
                    return;
                }
                if (i < text.length) {
                    storyTextElement.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, 30);
                } else {
                    skipBtn.style.display = 'none';
                    if (onComplete) onComplete();
                }
            }
            type();
        }

        // === GELİŞMİŞ OYUN SİSTEMLERİ ===
        
        // Oyun durumu kaydetme sistemi
        function saveGameState() {
            const saveData = {
                gameState: gameState,
                timestamp: Date.now(),
                version: '2.1.0'
            };
            localStorage.setItem('theEquals_save', JSON.stringify(saveData));
            showNotification('Oyun durumu kaydedildi!', 'success');
        }
        
        // Oyun durumu yükleme sistemi
        function loadGameState() {
            const saveData = localStorage.getItem('theEquals_save');
            if (saveData) {
                try {
                    const data = JSON.parse(saveData);
                    if (data.version === '2.1.0') {
                        Object.assign(gameState, data.gameState);
                        showNotification('Oyun durumu yüklendi!', 'success');
                        return true;
                    }
                } catch (e) {
                    console.error('Kayıt yükleme hatası:', e);
                }
            }
            return false;
        }
        
        // Oyunu başlatan fonksiyon
        function startGame() {
            // Kayıtlı oyun var mı kontrol et
            if (loadGameState()) {
                showNode('start');
            } else {
                showNode('start');
            }
        }

        // === GELİŞMİŞ ANİMASYON VE EFEKT FONKSİYONLARI ===
        
        // Buton tıklama animasyonu
        function animateButtonClick(button) {
            button.style.transform = 'scale(0.95)';
            button.style.transition = 'all 0.1s ease';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 100);
        }
        
        // Sayfa geçiş efekti
        function pageTransitionEffect() {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(45deg, #c94a4a, #74b9ff);
                z-index: 9999;
                opacity: 0;
                transition: opacity 0.3s ease;
            `;
            document.body.appendChild(overlay);
            
            setTimeout(() => overlay.style.opacity = '1', 10);
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => overlay.remove(), 300);
            }, 300);
        }
        
        // Karakter animasyonu
        function animateCharacterAppearance() {
            const chars = document.querySelectorAll('.character-card');
            chars.forEach((char, index) => {
                char.style.opacity = '0';
                char.style.transform = 'translateX(-20px)';
                char.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    char.style.opacity = '1';
                    char.style.transform = 'translateX(0)';
                }, index * 200);
            });
        }
        
        // İstatistik güncelleme animasyonu
        function animateStatUpdate(statName, oldValue, newValue) {
            const statElement = document.getElementById(`${statName}-value`);
            if (!statElement) return;
            
            const diff = newValue - oldValue;
            const color = diff > 0 ? '#00b894' : diff < 0 ? '#e17055' : '#74b9ff';
            
            statElement.style.color = color;
            statElement.style.transform = 'scale(1.2)';
            statElement.style.transition = 'all 0.3s ease';
            
            setTimeout(() => {
                statElement.style.color = '#e0e0e0';
                statElement.style.transform = 'scale(1)';
            }, 1000);
        }
        
        // Seçim yapıldığında çalışan fonksiyon
        function selectChoice(choice) {
            // Sesin kullanıcı etkileşimiyle başlamasını sağla
            if (!isSoundStarted) {
                ambienceSound.play();
                isSoundStarted = true;
            }
            
            // Buton animasyonu
            animateButtonClick(event.target);
            
            // Koşullu seçenek kontrolü
            if (!checkChoiceRequirements(choice)) {
                showNotification('Bu seçenek için yeterli kaynağınız yok!', 'error');
                return;
            }
            
            // Sayfa geçiş efekti
            pageTransitionEffect();
            
            // Değişkenleri güncelleme
            if (choice.set) {
                for (const key in choice.set) {
                    const value = choice.set[key];
                    const oldValue = gameState[key];
                    
                    if (typeof value === 'string' && value.startsWith('it')) {
                        const change = parseInt(value.split(' ')[1]);
                        gameState[key] += change;
                        
                        // İstatistik animasyonu
                        if (typeof oldValue === 'number') {
                            animateStatUpdate(key, oldValue, gameState[key]);
                        }
                        
                        // Görsel geribildirim
                        if (key === 'isyan_riski' && change > 0) {
                            showScreenFlash('rebellion');
                        } else if (key === 'halk_memnuniyeti' && change > 0) {
                            showScreenFlash('positive');
                        }
                    } else {
                        gameState[key] = value;
                    }
                }
            }
            
            // Gecikmeli sonuçlar ekle
            if (choice.delayedEffects) {
                for (const effect of choice.delayedEffects) {
                    gameState.gecikmeli_sonuclar.push({
                        triggerDay: gameState.oyun_gunu + effect.delay,
                        effects: effect.effects,
                        headline: effect.headline
                    });
                }
            }
            
            // Gazete manşeti göster
            if (choice.headline) {
                setTimeout(() => {
                    showNewspaper(choice.headline);
                }, 1000);
            }
            
            // Karakter güncelleme sistemi
            if (choice.characterUpdate) {
                for (const [characterName, updates] of Object.entries(choice.characterUpdate)) {
                    if (gameState.anahtar_karakterler[characterName]) {
                        Object.assign(gameState.anahtar_karakterler[characterName], updates);
                    }
                }
                // Karakter panelini güncelle
                setTimeout(() => updateRelationshipsPanel(), 500);
            }
            
            // İsim isteme gibi özel fonksiyonlar
            if (choice.prompt) {
                const name = prompt(choice.prompt.text);
                gameState[choice.prompt.variable] = name || "İsimsiz";
            }
            
            // Oyun gününü artır
            gameState.oyun_gunu++;
            
            // Otomatik kaydetme
            setTimeout(() => saveGameState(), 1000);
            
            // Rastgele olay tetikleme (%20 şans)
            if (Math.random() < 0.2) {
                triggerRandomEvent(function(eventHtml) {
                    showNode(choice.nextNode, eventHtml);
                });
            } else {
                showNode(choice.nextNode);
            }
        }

        // Arka plan değiştirme fonksiyonu
        function changeBackground(bgImage) {
            if (bgImage) {
                document.body.style.backgroundImage = `url(${bgImage})`;
            } else {
                document.body.style.backgroundImage = 'none';
            }
        }

        // İlgili hikaye bölümünü (node) ekrana getiren fonksiyon
        function showNode(nodeId, extraHtml) {
            const node = storyNodes[nodeId];

            // Gecikmeli sonuçları kontrol et
            checkDelayedEffects();

            // Arka planı değiştir
            if (node.background) {
                changeBackground(node.background);
            }

            // Metindeki değişkenleri değiştir
            let processedText = node.text
                .replace(/{karakter_adi}/g, gameState.karakter_adi)
                .replace(/{adalet_puani}/g, gameState.adalet_puani)
                .replace(/{guc_puani}/g, gameState.guc_puani)
                .replace(/{halk_destegi}/g, gameState.halk_destegi)
                .replace(/{halk_memnuniyeti}/g, gameState.halk_memnuniyeti)
                .replace(/{isyan_riski}/g, gameState.isyan_riski)
                .replace(/{hazine}/g, gameState.hazine)
                .replace(/{kisisel_vicdan}/g, gameState.kisisel_vicdan)
                .replace(/{teknoloji_seviyesi}/g, gameState.teknoloji_seviyesi);

            typeWriter(processedText, () => {
                // Yazma bittikten sonra ekstra html (rastgele olay) ekle
                if (extraHtml) {
                    storyTextElement.innerHTML += extraHtml;
                }
                // Yazma bittikten sonra seçenekleri göster
                while (choicesElement.firstChild) {
                    choicesElement.removeChild(choicesElement.firstChild);
                }

                if (node.choices) {
                    node.choices.forEach(choice => {
                        const button = document.createElement('button');
                        button.innerText = choice.text;
                        button.classList.add('choice-button');
                        
                        // Koşullu seçenek kontrolü
                        if (!checkChoiceRequirements(choice)) {
                            button.classList.add('disabled');
                            button.disabled = true;
                            
                            // Gereksinim metni ekle
                            if (choice.requirements) {
                                const reqText = document.createElement('div');
                                reqText.className = 'requirement-text';
                                reqText.textContent = `Gereksinim: ${Object.entries(choice.requirements).map(([stat, value]) => `${stat} >= ${value}`).join(', ')}`;
                                button.appendChild(reqText);
                            }
                        } else {
                            button.addEventListener('click', () => selectChoice(choice));
                        }
                        
                        choicesElement.appendChild(button);
                    });
                }
            });
            
            // Panelleri güncelle
            updateLeaderBoard();
            updateRelationshipsPanel();
            updateDebugPanel();
        }

        // === YENİ GELİŞMİŞ FONKSİYONLAR ===
        
        // Liderin panosunu güncelleyen fonksiyon
        function updateLeaderBoard() {
            // Güç puanı (0-100 arası normalize et)
            const powerPercent = Math.min(Math.max(gameState.guc_puani + 50, 0), 100);
            document.getElementById('power-fill').style.width = powerPercent + '%';
            document.getElementById('power-value').textContent = gameState.guc_puani;
            
            // Adalet puanı
            const justicePercent = Math.min(Math.max(gameState.adalet_puani + 50, 0), 100);
            document.getElementById('justice-fill').style.width = justicePercent + '%';
            document.getElementById('justice-value').textContent = gameState.adalet_puani;
            
            // Halk desteği
            const supportPercent = Math.min(Math.max(gameState.halk_destegi + 50, 0), 100);
            document.getElementById('support-fill').style.width = supportPercent + '%';
            document.getElementById('support-value').textContent = gameState.halk_destegi;
            
            // Halk memnuniyeti
            const satisfactionPercent = Math.min(Math.max(gameState.halk_memnuniyeti + 50, 0), 100);
            document.getElementById('satisfaction-fill').style.width = satisfactionPercent + '%';
            document.getElementById('satisfaction-value').textContent = gameState.halk_memnuniyeti;
            
            // İsyan riski
            const rebellionPercent = Math.min(Math.max(gameState.isyan_riski, 0), 100);
            document.getElementById('rebellion-fill').style.width = rebellionPercent + '%';
            document.getElementById('rebellion-value').textContent = gameState.isyan_riski;
            
            // Hazine
            const treasuryPercent = Math.min(Math.max(gameState.hazine, 0), 100);
            document.getElementById('treasury-fill').style.width = treasuryPercent + '%';
            document.getElementById('treasury-value').textContent = gameState.hazine;
            
            // Kişisel vicdan
            const consciencePercent = Math.min(Math.max(gameState.kisisel_vicdan + 50, 0), 100);
            document.getElementById('conscience-fill').style.width = consciencePercent + '%';
            document.getElementById('conscience-value').textContent = gameState.kisisel_vicdan;
        }
        
        // İlişkiler panelini güncelleyen fonksiyon
        function updateRelationshipsPanel() {
            const content = document.getElementById('relationships-content');
            let html = '';
            
            for (const [name, character] of Object.entries(gameState.anahtar_karakterler)) {
                const statusClass = character.iliski === 'sadık' ? 'status-loyal' : 
                                  character.iliski === 'kırgın' ? 'status-angry' : 'status-enemy';
                const statusText = character.iliski === 'sadık' ? 'Sadık' : 
                                 character.iliski === 'kırgın' ? 'Kırgın' : 'Düşman';
                
                const conditionClass = character.durum === 'güvende' ? 'status-safe' : 
                                     character.durum === 'hapiste' ? 'status-prison' : 'status-exile';
                const conditionText = character.durum === 'güvende' ? 'Güvende' : 
                                    character.durum === 'hapiste' ? 'Hapiste' : 'Sürgünde';
                
                html += `
                    <div class="character-card">
                        <div class="character-name">${name.charAt(0).toUpperCase() + name.slice(1)}</div>
                        <div class="character-status ${statusClass}">İlişki: ${statusText}</div>
                        <div class="character-status ${conditionClass}">Durum: ${conditionText}</div>
                    </div>
                `;
            }
            
            content.innerHTML = html;
        }
        
        // === GELİŞMİŞ BİLDİRİM VE EFEKT SİSTEMİ ===
        
        // Bildirim sistemi
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? '#e17055' : type === 'success' ? '#00b894' : '#74b9ff'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                transform: translateX(100%);
                transition: all 0.3s ease;
                max-width: 300px;
                font-weight: bold;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.style.transform = 'translateX(0)', 10);
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Gelişmiş ekran flash efekti
        function showScreenFlash(type, duration = 1000) {
            const flash = document.getElementById('screen-flash');
            flash.className = `screen-flash ${type}`;
            flash.style.opacity = '1';
            
            // Ses efekti ekle
            if (type === 'rebellion') {
                playSoundEffect('warning');
            } else if (type === 'positive') {
                playSoundEffect('success');
            }
            
            setTimeout(() => {
                flash.style.opacity = '0';
            }, duration);
        }
        
        // Ses efektleri
        function playSoundEffect(type) {
            const audio = new Audio();
            audio.volume = 0.3;
            
            const sounds = {
                'warning': 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT',
                'success': 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT'
            };
            
            if (sounds[type]) {
                audio.src = sounds[type];
                audio.play().catch(() => {}); // Ses çalma hatalarını yoksay
            }
        }
        
        // Gazete manşeti göster
        function showNewspaper(headline, date = null) {
            const newspaper = document.getElementById('newspaper');
            const title = document.getElementById('newspaper-title');
            const dateElement = document.getElementById('newspaper-date');
            
            title.textContent = headline;
            dateElement.textContent = date || `Gün ${gameState.oyun_gunu}`;
            
            newspaper.classList.add('show');
        }
        
        // Gazete manşetini kapat
        function closeNewspaper() {
            document.getElementById('newspaper').classList.remove('show');
        }
        
        // Lore tooltip göster
        function showLoreTooltip(text, x, y) {
            const tooltip = document.getElementById('lore-tooltip');
            tooltip.textContent = text;
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
            tooltip.classList.add('show');
        }
        
        // Lore tooltip gizle
        function hideLoreTooltip() {
            document.getElementById('lore-tooltip').classList.remove('show');
        }
        
        // Rastgele olay tetikle
        function triggerRandomEvent(callback) {
            const events = [
                {
                    title: "Kıtlık Söylentileri",
                    text: "Halk arasında kıtlık söylentileri yayılıyor. Panik artıyor.",
                    effects: { halk_memnuniyeti: -5 }
                },
                {
                    title: "Başarılı Hasat",
                    text: "Bu yıl hasat çok başarılı oldu. Halk memnun.",
                    effects: { hazine: 10, halk_memnuniyeti: 5 }
                },
                {
                    title: "Mülteci Akını",
                    text: "Komşu ülkeden mülteci akını başladı. Halk endişeli.",
                    effects: { halk_destegi: -5, isyan_riski: 5 }
                },
                {
                    title: "Teknoloji Atılımı",
                    text: "Yerli bilim insanları önemli bir buluş yaptı.",
                    effects: { teknoloji_seviyesi: 2 }
                },
                {
                    title: "Dış Ticaret Anlaşması",
                    text: "Zertan ile ticaret anlaşması imzalandı.",
                    effects: { hazine: 20, dis_politika_durumu: 'tarafsız' }
                }
            ];
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            const eventHtml = `
                <div class=\"random-event\">\n                    <div class=\"event-title\">${randomEvent.title}</div>\n                    <div>${randomEvent.text}</div>\n                </div>\n            `;
            // Efektleri uygula
            for (const [stat, change] of Object.entries(randomEvent.effects)) {
                if (typeof gameState[stat] === 'number') {
                    gameState[stat] += change;
                } else {
                    gameState[stat] = change;
                }
            }
            updateLeaderBoard();
            if (callback) callback(eventHtml);
        }
        
        // Koşullu seçenek kontrolü
        function checkChoiceRequirements(choice) {
            if (!choice.requirements) return true;
            
            for (const [stat, value] of Object.entries(choice.requirements)) {
                if (gameState[stat] < value) return false;
            }
            return true;
        }
        
        // Gecikmeli sonuçları kontrol et
        function checkDelayedEffects() {
            const currentTime = gameState.oyun_gunu;
            const completedEffects = [];
            
            for (let i = 0; i < gameState.gecikmeli_sonuclar.length; i++) {
                const effect = gameState.gecikmeli_sonuclar[i];
                if (effect.triggerDay <= currentTime) {
                    // Efekti uygula
                    for (const [stat, change] of Object.entries(effect.effects)) {
                        gameState[stat] += change;
                    }
                    
                    // Gazete manşeti göster
                    if (effect.headline) {
                        showNewspaper(effect.headline);
                    }
                    
                    completedEffects.push(i);
                }
            }
            
            // Tamamlanan efektleri listeden çıkar
            for (let i = completedEffects.length - 1; i >= 0; i--) {
                gameState.gecikmeli_sonuclar.splice(completedEffects[i], 1);
            }
        }
        
        // Debug panelini güncelleyen fonksiyon (eski)
        function updateDebugPanel() {
            debugInfoElement.innerHTML = `
                Ad: ${gameState.karakter_adi}<br>
                Adalet: ${gameState.adalet_puani}<br>
                Güç: ${gameState.guc_puani}<br>
                Halk Desteği: ${gameState.halk_destegi}<br>
                Halk Memnuniyeti: ${gameState.halk_memnuniyeti}<br>
                İsyan Riski: ${gameState.isyan_riski}<br>
                Hazine: ${gameState.hazine}<br>
                Kişisel Vicdan: ${gameState.kisisel_vicdan}<br>
                Dış Politika: ${gameState.dis_politika_durumu}<br>
                Teknoloji: ${gameState.teknoloji_seviyesi}
            `;
        }

        // === HİKAYE VERİSİ (JSON formatında) ===

        const storyNodes = {
            // === BÖLÜM 1.0: BAŞLANGIÇ & İLK KARAR ===
            'start': {
                text: "Şehrin kenar mahallesinde, gri beton blokların arasında yaşıyorsun.\n\nYukarıda, merkezdeki zenginlerin camdan gökdelenleri gökyüzüne dikilmiş. Her sabah aynı eziklikle işe gidiyorsun.\n\nBu düzenin bir parçasısın. Şimdilik.\n\nAdın ne?",
                background: "BGs/tordah_Urban_outskirts_gray_concrete_apartment_blocks_working_9beac87a-9211-4f41-abe8-aa8b13b93e36_1.png",
                choices: [
                    {
                        text: "Adımı söyle",
                        prompt: { text: "Adın ne?", variable: "karakter_adi" },
                        nextNode: 'ilk_karar'
                    }
                ]
            },
            'ilk_karar': {
                text: "Hoş geldin, {karakter_adi}.\n\nBugün maaşının kesildiğini, patronunun ise yeni bir lüks araba aldığını öğrendin. Sokakta bir zengin çocuğu sana acıyarak baktı.\n\nBu kırılma anında ne yapacaksın?",
                background: "BGs/tordah_Office_building_exterior_sleek_corporate_facade_luxury_b5c5fac0-53c5-4776-af88-71ebf5cf4394_2.png",
                choices: [
                    {
                        text: "Başını eğ ve bu çürümüş düzende yaşamaya devam et.",
                        set: { halk_destegi: 'it -5', adalet_puani: 'it -10' },
                        nextNode: 'son_sessizlik'
                    },
                    {
                        text: "Yeter artık! İçindeki kıvılcımı bir yangına dönüştür.",
                        set: { halk_destegi: 'it +10', adalet_puani: 'it +15', bolum: 2 },
                        nextNode: 'ilk_direnis'
                    }
                ]
            },
            'son_sessizlik': {
                text: "Başını öne eğdin. Güvenli yolu seçtin. Ya da en azından şimdilik öyle görünüyor.\n\nAma her gece o çocuğun bakışlarını ve kendi sessizliğinin yankısını duyacaksın.\n\nDöngü devam ediyor.\n\nOyun bitti.",
                background: "BGs/tordah_Indoor_office_hallway_subdued_lighting_solitary_figure_28bd36ad-c4d4-4e83-af39-b06159512f2f_3.png"
            },
            // === BÖLÜM 1.1: İLK DİRENİŞ ===
            'ilk_direnis': {
                text: "İçindeki öfke ve adalet ateşiyle işyerine döndün.\n\nSadece bir kıvılcım yetecek. Ama dikkatli olmalısın. Kime güvenebilirsin?\n\nAhmet, senin gibi düşünen yorgun bir işçi.\nMehmet ise patronun gözdesi, bir muhbir olabilir.",
                background: "BGs/tordah_Industrial_factory_interior_workers_in_uniforms_with_c_7b0c1859-10de-4326-b715-a245569f7257_2.png",
                choices: [
                    {
                        text: "Risk al. Ahmet'le birlikte hemen küçük bir protesto organize et.",
                        set: { guc_puani: 'it +5', halk_destegi: 'it +15' },
                        nextNode: 'orgut_yapisi_secimi'
                    },
                    {
                        text: "Aklını kullan. Önce Mehmet'i ikna etmeyi dene. Düşmanını dostun yap.",
                        set: { adalet_puani: 'it +10', halk_destegi: 'it +5' },
                        nextNode: 'mehmet_ikna'
                    },
                    {
                        text: "Sabırlı ol. Önce daha fazla insanla gizlice konuş, zemin oluştur.",
                        set: { adalet_puani: 'it +5', halk_destegi: 'it +20' },
                        nextNode: 'gizli_orgutlenme'
                    }
                ]
            },
            // === ÖRGÜT YAPISI SEÇİMİ ===
            'orgut_yapisi_secimi': {
                text: "İlk eylem başarılı oldu. Şimdi nasıl örgütleneceksiniz?\n\nBu seçim, tüm devrim sürecinizi etkileyecek.",
                background: "BGs/tordah_Secret_underground_meeting_room_dimly_lit_small_group__2a2a3ec5-0dd8-4ec4-87f3-18ce9de3249a_1.png",
                choices: [
                    {
                        text: "Merkeziyetçi Öncü Parti - Hızlı kararlar, güçlü liderlik",
                        set: { guc_puani: 'it +10', orgut_yapisi: 'merkeziyetçi', adalet_puani: 'it -5' },
                        nextNode: 'ilk_protesto_organizasyonu'
                    },
                    {
                        text: "Yatay ve Otonom Kolektifler - Demokratik, yavaş ama güçlü taban",
                        set: { halk_destegi: 'it +15', orgut_yapisi: 'yatay', guc_puani: 'it -5', adalet_puani: 'it +10' },
                        nextNode: 'ilk_protesto_organizasyonu'
                    }
                ]
            },
            // === YENİ ARA BÖLÜMLER ===
            'ilk_protesto_organizasyonu': {
                text: "Ahmet ile birlikte hemen harekete geçtin. Mola saatinde küçük bir toplantı yaptınız.\n\nSadece 5-6 kişi, ama bu bir başlangıç. İlk protestonuzu nasıl yapacaksınız?",
                background: "BGs/tordah_Cafeteria_break_room_workers_gathered_in_a_circle_whis_c9b73244-ddd5-4d4b-88e3-7526295bde51_2.png",
                choices: [
                    {
                        text: "Sessiz protesto - Pankartlarla işyeri önünde durma",
                        set: { adalet_puani: 'it +10', halk_destegi: 'it +10' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "Sesli protesto - Sloganlarla dikkat çekme",
                        set: { guc_puani: 'it +10', halk_destegi: 'it +15', isyan_riski: 'it +5' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "İş bırakma - Kısa süreli grev",
                        set: { guc_puani: 'it +15', halk_destegi: 'it +20', isyan_riski: 'it +10' },
                        nextNode: 'kivilcim_buyuyor'
                    }
                ]
            },
            'mehmet_ikna': {
                text: "Mehmet ile konuştun. Başta tereddüt etti, ama sonunda gerçeği gördü.\n\nO da aynı adaletsizlikleri yaşıyor. 'Belki de haklısın' dedi.\n\nŞimdi Mehmet'i de yanınıza alarak ne yapacaksınız?",
                background: "BGs/tordah_Industrial_factory_interior_workers_in_uniforms_with_c_7b0c1859-10de-4326-b715-a245569f7257_2.png",
                choices: [
                    {
                        text: "Güvenli yaklaşım - Önce daha fazla kişi bul",
                        set: { adalet_puani: 'it +10', halk_destegi: 'it +10' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "Cesur hamle - Mehmet'in patronla bağlantısını kullan",
                        set: { guc_puani: 'it +15', halk_destegi: 'it +15', isyan_riski: 'it +10' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "Stratejik plan - İçeriden bilgi toplama",
                        set: { adalet_puani: 'it +5', guc_puani: 'it +10', halk_destegi: 'it +15' },
                        nextNode: 'kivilcim_buyuyor'
                    }
                ]
            },
            'gizli_orgutlenme': {
                text: "Sabırlı bir yaklaşım seçtin. Önce daha fazla insanla gizlice konuştun.\n\nÇoğu kişi aynı fikirde! 20'den fazla kişi seninle aynı düşünüyor.\n\nBu büyük bir başarı! Şimdi nasıl örgütleneceksiniz?",
                background: "BGs/tordah_Secret_underground_meeting_room_dimly_lit_small_group__2a2a3ec5-0dd8-4ec4-87f3-18ce9de3249a_1.png",
                choices: [
                    {
                        text: "Yeraltı örgütü - Gizli toplantılar ve planlar",
                        set: { adalet_puani: 'it +15', halk_destegi: 'it +20' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "Açık hareket - Herkesi bilgilendirerek büyüt",
                        set: { halk_destegi: 'it +25', isyan_riski: 'it +15' },
                        nextNode: 'kivilcim_buyuyor'
                    },
                    {
                        text: "Karma strateji - Hem gizli hem açık çalış",
                        set: { adalet_puani: 'it +10', guc_puani: 'it +10', halk_destegi: 'it +15' },
                        nextNode: 'kivilcim_buyuyor'
                    }
                ]
            },
            // === BÖLÜM 1.2: KIVILCIM BÜYÜYOR ===
            'kivilcim_buyuyor': {
                text: "Küçük grup, ilk ses getiren eylemini planlıyor. Amaç dikkat çekmek mi, yoksa kaynak toplamak mı?",
                background: "BGs/tordah_Activist_headquarters_maps_and_strategy_boards_passion_54439e8a-7feb-4d17-b0bd-12393032b32d_2.png",
                choices: [
                    {
                        text: "Propaganda Eylemi - Pankart asmak, yayın yapmak",
                        set: { halk_destegi: 'it +10', adalet_puani: 'it +10', secilen_yol: 'propaganda' },
                        nextNode: 'propaganda_eylemi'
                    },
                    {
                        text: "Sabotaj Eylemi - Elitlere ait bir fabrikanın üretimini durdurmak",
                        set: { guc_puani: 'it +15', isyan_riski: 'it +10', secilen_yol: 'sabotaj' },
                        nextNode: 'sabotaj_eylemi'
                    }
                ]
            },
            'propaganda_eylemi': {
                text: "Propaganda eylemi seçtin. Pankartlar hazırladınız ve yayınlar yaptınız.\n\nHalk arasında ses getirdiniz. Bazıları destekliyor, bazıları korkuyor.\n\nBu başarıyı nasıl sürdüreceksiniz?",
                background: "BGs/tordah_Outdoor_street_protest_crowds_holding_banners_chanting_fbbb45fe-c8-40ef-8ba4-b921471f9203_3.png",
                choices: [
                    {
                        text: "Daha fazla propaganda - Broşür dağıtımı ve konuşmalar",
                        set: { halk_destegi: 'it +15', adalet_puani: 'it +10' },
                        nextNode: 'müttefikler'
                    },
                    {
                        text: "Sosyal medya kampanyası - Dijital propaganda",
                        set: { halk_destegi: 'it +20', isyan_riski: 'it +5' },
                        nextNode: 'müttefikler'
                    },
                    {
                        text: "Yerel liderlerle görüşme - Topluluk desteği",
                        set: { adalet_puani: 'it +15', halk_destegi: 'it +10' },
                        nextNode: 'müttefikler'
                    }
                ]
            },
            'sabotaj_eylemi': {
                text: "Sabotaj eylemi seçtin. Zenginlere ait bir fabrikanın üretimini durdurdunuz.\n\nBu dikkat çekti ama riskli bir hamle. Zenginler tepki verecek.\n\nBu durumu nasıl yöneteceksiniz?",
                background: "BGs/tordah_Industrial_factory_interior_workers_in_uniforms_with_c_7b0c1859-10de-4326-b715-a245569f7257_2.png",
                choices: [
                    {
                        text: "Gizlenme - Kimliği gizli tut, kaç",
                        set: { guc_puani: 'it +10', isyan_riski: 'it +5' },
                        nextNode: 'müttefikler'
                    },
                    {
                        text: "Sahiplenme - Eylemi üstlen, kahraman ol",
                        set: { guc_puani: 'it +20', halk_destegi: 'it +15', isyan_riski: 'it +15' },
                        nextNode: 'müttefikler'
                    },
                    {
                        text: "Stratejik geri çekilme - Zaman kazan",
                        set: { adalet_puani: 'it +5', guc_puani: 'it +5' },
                        nextNode: 'müttefikler'
                    }
                ]
            },
            // === BÖLÜM 1.3: MÜTTEFİKLER ===
            'müttefikler': {
                text: "Hareket büyüdü ve diğer grupların dikkatini çekti. Kiminle ittifak kuracaksın?",
                background: "BGs/tordah_Diverse_group_of_activists_in_a_grand_hall_shaking_han_4c9953bf-212a-4725-9daf-495e9e1ed89c_2.png",
                choices: [
                    {
                        text: "Radikal Öğrenci Grupları - Hızlı ve etkili ama kontrol zor",
                        set: { halk_destegi: 'it +15', guc_puani: 'it +10', müttefik: 'öğrenci' },
                        nextNode: 'ogrenci_ittifaki'
                    },
                    {
                        text: "Pragmatik İşçi Sendikaları - Genel grev gücü ama ekonomik talepleri var",
                        set: { guc_puani: 'it +20', adalet_puani: 'it -5', müttefik: 'sendika' },
                        nextNode: 'sendika_ittifaki'
                    },
                    {
                        text: "Yavaş Ama Etkili Entelektüeller - Medya gücü ve uluslararası destek",
                        set: { adalet_puani: 'it +20', halk_destegi: 'it +5', müttefik: 'entelektüel' },
                        nextNode: 'entelektuel_ittifaki'
                    }
                ]
            },
            'entelektuel_ittifaki': {
                text: "Entelektüellerle ittifak kurdun. Medya gücü ve uluslararası destek vaadi var.\n\nOnlar daha yavaş ama etkili bir yaklaşım istiyor. Nasıl ilerleyeceksiniz?",
                background: "BGs/tordah_Elegant_academic_library_room_intellectuals_in_discuss_b79324c3-4f6a-4f6f-9729-dcdcd267c731_2.png",
                choices: [
                    {
                        text: "Onların stratejisini benimse - Yavaş ama etkili",
                        set: { adalet_puani: 'it +20', halk_destegi: 'it +10' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Hızlandır - Entelektüelleri ikna et",
                        set: { guc_puani: 'it +10', adalet_puani: 'it +10', halk_destegi: 'it +15' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Medya kampanyası - Entelektüellerin gücünü kullan",
                        set: { adalet_puani: 'it +15', halk_destegi: 'it +20' },
                        nextNode: 'elif_tutuklanmasi'
                    }
                ]
            },
            'ogrenci_ittifaki': {
                text: "Öğrenci gruplarıyla ittifak kurdun. Genç ve enerjik, ama bazen kontrol edilmesi zor.\n\nOnlar hızlı eylemler istiyor. Nasıl bir strateji izleyeceksiniz?",
                background: "BGs/tordah_University_quad_students_holding_signs_youthful_energy_a1c1a075-34bf-43b7-bdc8-52ef2860b7d1_2.png",
                choices: [
                    {
                        text: "Onların hızına ayak uydur - Hızlı ve agresif eylemler",
                        set: { guc_puani: 'it +15', halk_destegi: 'it +10', isyan_riski: 'it +10' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Onları yavaşlat - Daha stratejik yaklaşım",
                        set: { adalet_puani: 'it +10', halk_destegi: 'it +5' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Karma strateji - Hem hızlı hem düşünceli",
                        set: { adalet_puani: 'it +5', guc_puani: 'it +10', halk_destegi: 'it +10' },
                        nextNode: 'elif_tutuklanmasi'
                    }
                ]
            },
            'sendika_ittifaki': {
                text: "İşçi sendikalarıyla ittifak kurdun. Güçlü ama ekonomik talepleri var.\n\nOnlar genel grev istiyor. Bu büyük bir hamle. Nasıl karşılık vereceksin?",
                background: "BGs/tordah_Union_hall_room_rows_of_workers_seated_speaker_at_podi_657a3d1c-6a4e-4776-a947-b8898390292f_0.png",
                choices: [
                    {
                        text: "Genel grevi destekle - Büyük risk, büyük ödül",
                        set: { guc_puani: 'it +25', halk_destegi: 'it +20', isyan_riski: 'it +20' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Kademeli grev - Daha kontrollü yaklaşım",
                        set: { guc_puani: 'it +15', adalet_puani: 'it +10', halk_destegi: 'it +15' },
                        nextNode: 'elif_tutuklanmasi'
                    },
                    {
                        text: "Ekonomik talepleri öncele - Sendikaları memnun et",
                        set: { adalet_puani: 'it +15', halk_destegi: 'it +10' },
                        nextNode: 'elif_tutuklanmasi'
                    }
                ]
            },
            'entelektuel_ittifaki_2': {
                text: "Entelektüellerle ittifak kurdun. Medya gücü ve uluslararası destek vaadi var.\n\nOnlar daha yavaş ama etkili bir yaklaşım istiyor. Nasıl ilerleyeceksiniz?",
                background: "BGs/tordah_Elegant_academic_library_room_intellectuals_in_discuss_b79324c3-4f6a-4f6f-9729-dcdcd267c731_2.png",
                choices: [
                    {
                        text: "Onların stratejisini benimse - Yavaş ama etkili",
                        set: { adalet_puani: 'it +20', halk_destegi: 'it +10' },
                        nextNode: 'devletin_cevabi'
                    },
                    {
                        text: "Hızlandır - Entelektüelleri ikna et",
                        set: { guc_puani: 'it +10', adalet_puani: 'it +10', halk_destegi: 'it +15' },
                        nextNode: 'devletin_cevabi'
                    },
                    {
                        text: "Medya kampanyası - Entelektüellerin gücünü kullan",
                        set: { adalet_puani: 'it +15', halk_destegi: 'it +20' },
                        nextNode: 'devletin_cevabi'
                    }
                ]
            },
            // === ELİF'İN TUTUKLANMASI ===
            'elif_tutuklanmasi': {
                text: "Hareket büyüdükçe, Elitler daha agresif hale geldi.\n\nBir sabah, en yakın arkadaşın Elif'i 'isyana yardım ve yataklık' suçlamasıyla tutukladılar.\n\nElif, devrimin idealist yüzünü temsil ediyordu. Politikadan uzak duruyordu ama seninle aynı değerleri paylaşıyordu.\n\nNe yapacaksın?",
                background: "BGs/tordah_Nighttime_street_police_in_riot_gear_arresting_a_defia_f9138b9a-4aff-419c-89a7-285ad43db9b6_2.png",
                choices: [
                    {
                        text: "Hareketi riske atmamak için sessiz kal. Elif'i feda et.",
                        set: { kisisel_vicdan: 'it -15', guc_puani: 'it +5' },
                        characterUpdate: { elif: { durum: 'hapiste', iliski: 'kırgın' } },
                        nextNode: 'devletin_cevabi'
                    },
                    {
                        text: "Müttefiklerini kullanarak Elif'i kurtarmak için eylem düzenle.",
                        set: { halk_destegi: 'it -10', adalet_puani: 'it +10', kisisel_vicdan: 'it +10' },
                        characterUpdate: { elif: { durum: 'kurtarıldı', iliski: 'sadık' } },
                        nextNode: 'devletin_cevabi'
                    },
                    {
                        text: "Elitlerle gizli anlaşma yap. Elif'i serbest bırak, sen de yavaşla.",
                        set: { kisisel_vicdan: 'it +5', guc_puani: 'it -10' },
                        characterUpdate: { elif: { durum: 'güvende', iliski: 'sadık' } },
                        nextNode: 'devletin_cevabi'
                    }
                ]
            },
            // === BÖLÜM 1.4: DEVLETİN CEVABI ===
            'devletin_cevabi': {
                text: "Hareketin artık görmezden gelinemez. Elitler karşılık verir.\n\nGüvenlik şefi, hareketin liderlerinden birini 'feda etmeni' karşılığında baskıyı azaltmayı teklif eder.\n\nBu ahlaki ikilemde ne yapacaksın?",
                background: "BGs/tordah_Government_building_facade_armored_vehicles_riot_polic_579909b8-a283-4c55-bbac-8069d6e9c9ed_1.png",
                choices: [
                    {
                        text: "Teklifi reddet - Tüm gücümüzle direneceğiz!",
                        set: { isyan_riski: 'it +20', halk_destegi: 'it +15' },
                        nextNode: 'devrimin_esiginde'
                    },
                    {
                        text: "Bir yoldaşını feda et - Bu savaşta kurbanlar olacak.",
                        set: { guc_puani: 'it +25', adalet_puani: 'it -15' },
                        nextNode: 'devrimin_esiginde'
                    },
                    {
                        text: "Gizli anlaşma - Baskıyı azalt, biz de yavaşlayalım.",
                        set: { halk_destegi: 'it -10', adalet_puani: 'it -10', guc_puani: 'it -10' },
                        nextNode: 'devrimin_esiginde'
                    }
                ]
            },
            // === BÖLÜM 1.5: DEVRİMİN EŞİĞİNDE ===
            'devrimin_esiginde': {
                text: "Her şey bu ana bağlı. Halk sokaklarda. Saray'ın kapısındasın.\n\nSon hamle ne olacak?",
                background: "BGs/tordah_Grand_palace_gates_surrounded_by_masses_revolutionary__191ae2f4-d567-42c7-a546-c8f9a5789f0a_3.png",
                choices: [
                    {
                        text: "Kanlı devrim - Saray'a saldırı emri ver",
                        set: { guc_puani: 'it +25', halk_destegi: 'it -10' },
                        nextNode: 'perde2_gecis'
                    },
                    {
                        text: "Barışçıl devrim - Milyonluk yürüyüşle Saray'ı kuşat",
                        set: { adalet_puani: 'it +25', halk_destegi: 'it +20' },
                        nextNode: 'perde2_gecis'
                    },
                    {
                        text: "Müzakere - Elitlerle son bir kez masaya otur",
                        set: { adalet_puani: 'it +15', guc_puani: 'it +15', halk_destegi: 'it +15' },
                        nextNode: 'perde2_gecis'
                    }
                ]
            },
            // === BÖLÜM 2.0: GEÇİŞ - DEVRİM SONRASI ===
            'perde2_gecis': {
                text: "*** DEVRİM SONRASI ***\n\nDevrim başarılı oldu! Artık lüks bir ofistesin ve bir Lider oldun.\n\nAma zaferin bedeli ağır. Devrim yüzünden tedarik zinciri koptu, hazine boş, halk aç ve sabırsız.\n\nİlk büyük krizle karşı karşıyasın.",
                background: "BGs/tordah_Inside_opulent_government_office_officials_watching_ne_b40f4301-68c4-400b-937e-2cd4f0b1cd5f_2.png",
                choices: [
                    {
                        text: "Devam et",
                        nextNode: 'zaferin_bedeli'
                    }
                ]
            },
            // === BÖLÜM 2.1: ZAFERİN BEDELİ ===
            'zaferin_bedeli': {
                text: "Yeni hükümetin ilk büyük krizi: Kıtlık.\n\nDevrim yüzünden tedarik zinciri koptu. Hazine boş. Halk aç ve sabırsız.\n\nAcil çözüm ne olacak?",
                background: "BGs/tordah_Empty_supermarket_shelves_starving_citizens_queuing_ec_2f316f44-6f83-4cca-92ec-e0a7c10a05bd_2.png",
                choices: [
                    {
                        text: "Hazineyi kullan - Kalan parayla dışarıdan gıda al",
                        set: { hazine: 'it -40', halk_memnuniyeti: 'it +15' },
                        nextNode: 'eski_hayaletler'
                    },
                    {
                        text: "Karne sistemi - Herkese eşit ama az gıda",
                        set: { adalet_puani: 'it +10', halk_memnuniyeti: 'it -10' },
                        headline: "Lider {karakter_adi} Kemer Sıkma Politikalarını Açıkladı: Halk Endişeli!",
                        nextNode: 'eski_hayaletler'
                    },
                    {
                        text: "Zenginlerin mallarına el koy - Eski zenginlerin stoklarını halka dağıt",
                        set: { guc_puani: 'it +15', halk_memnuniyeti: 'it +20', isyan_riski: 'it +10' },
                        nextNode: 'zertan_tehdidi'
                    }
                ]
            },
            // === ZERTAN TEHDİDİ ===
            'zertan_tehdidi': {
                text: "Devrimden sonra, komşu ve güçlü Zertan İmparatorluğu endişeleniyor.\n\nSınırda askeri tatbikatlara başladılar. Ülkedeki karşı-devrimci gruplara gizlice destek veriyorlar.\n\nZertan, devrimin kendi topraklarına sıçramasından korkuyor.\n\nNasıl karşılık vereceksin?",
                background: "BGs/tordah_Military_checkpoint_at_border_tanks_and_troops_poised__686c54ca-b97c-4814-8f1d-207171424018_0.png",
                choices: [
                    {
                        text: "Sert ültimatom ver. Savaş riskini göze al.",
                        set: { dis_politika_durumu: 'gergin', isyan_riski: 'it +10', guc_puani: 'it +15', zertan_tehdidi: 'it +20' },
                        nextNode: 'eski_hayaletler'
                    },
                    {
                        text: "Diplomasi yolunu seç. Zertan'a tavizler ver.",
                        set: { dis_politika_durumu: 'tarafsız', hazine: 'it -20', adalet_puani: 'it -10', zertan_tehdidi: 'it -10' },
                        nextNode: 'eski_hayaletler'
                    },
                    {
                        text: "Teknolojiyi kullan. Siber propaganda kampanyası başlat.",
                        set: { dis_politika_durumu: 'gergin', guc_puani: 'it +10', isyan_riski: 'it -5', teknoloji_seviyesi: 'it -2', zertan_tehdidi: 'it +5' },
                        requirements: { teknoloji_seviyesi: 10 },
                        headline: "Siber Saldırı Skandalı: Zertan'da Büyük Panik!",
                        nextNode: 'eski_hayaletler'
                    }
                ]
            },
            // === BÖLÜM 2.2: ESKİ HAYALETLER ===
            'eski_hayaletler': {
                text: "Eski rejimin kalıntıları hala devlette. Bürokrasi reformlarını sabote ediyor.\n\nBürokrasiyi nasıl temizleyeceksin?",
                background: "BGs/tordah_Grand_bureaucratic_office_with_ghostly_figures_of_past_e09cc08b-8a24-47df-a173-58ecd55e9bc9_2.png",
                choices: [
                    {
                        text: "Tasfiye - Sana sadık olmayanları temizle",
                        set: { guc_puani: 'it +20', isyan_riski: 'it +15' },
                        headline: "Devlette Büyük Temizlik: Kahraman mı, Diktatör mü?",
                        delayedEffects: [{
                            delay: 3,
                            effects: { isyan_riski: 10 },
                            headline: "Sadık Kadrolar Arasında Huzursuzluk Artıyor!"
                        }],
                        nextNode: 'yoldaslar_arasinda_catlak'
                    },
                    {
                        text: "Liyakat - Herkesi sınava tabi tut, en iyisi kalsın",
                        set: { adalet_puani: 'it +20', hazine: 'it -20' },
                        nextNode: 'yoldaslar_arasinda_catlak'
                    },
                    {
                        text: "Uzlaşma - Eski bürokratlarla anlaş",
                        set: { guc_puani: 'it -5', adalet_puani: 'it -5' },
                        nextNode: 'yoldaslar_arasinda_catlak'
                    }
                ]
            },
            // === BÖLÜM 2.3: YOLDAŞLAR ARASINDA ÇATLAK ===
            'yoldaslar_arasinda_catlak': {
                text: "Devrimi birlikte yaptığın eski bir yoldaşın, politikalarının 'fazla yumuşak' olduğunu söyleyerek seni halka açık şekilde eleştiriyor.\n\nEski dostuna ne yapacaksın?",
                background: "BGs/tordah_Group_of_revolutionaries_arguing_heatedly_in_a_worn-do_d5a80d38-ed86-4a37-9265-5558f0543bf0_1.png",
                choices: [
                    {
                        text: "Onu dinle - Politikalarını sertleştir",
                        set: { guc_puani: 'it +10', halk_memnuniyeti: 'it -10', yoldas_durumu: 'radikal' },
                        nextNode: 'elif_elestirisi'
                    },
                    {
                        text: "Onu görevden al - Otoritene meydan okuyamaz",
                        set: { guc_puani: 'it +15', isyan_riski: 'it +10', yoldas_durumu: 'muhalif' },
                        nextNode: 'elif_elestirisi'
                    },
                    {
                        text: "Onu sürgüne gönder - Tartışmalı ama kansız çözüm",
                        set: { adalet_puani: 'it -10', yoldas_durumu: 'sürgün' },
                        nextNode: 'elif_elestirisi'
                    }
                ]
            },
            // === ELİF'İN ELEŞTİRİSİ ===
            'elif_elestirisi': {
                text: "Elif, senin lider olarak aldığın sert kararları eleştiriyor.\n\n'Bu devrim değil, {karakter_adi}. Sen de onlar gibi oldun. Karne sistemi, tasfiyeler... Halk aç ve korkuyor.'\n\nElif'in sözleri doğru. Ama güç kaybetmek istemiyorsun.\n\nNe yapacaksın?",
                background: "BGs/tordah_Intense_private_confrontation_in_dim_lit_room_one_figu_b3ae36f9-3f3f-4fad-b3c4-8341bf959fc8_3.png",
                choices: [
                    {
                        text: "Onu 'devrim karşıtı propaganda' yapmaktan sustur.",
                        set: { guc_puani: 'it +10', kisisel_vicdan: 'it -20' },
                        characterUpdate: { elif: { iliski: 'düşman' } },
                        nextNode: 'ilk_muhalif_sesler'
                    },
                    {
                        text: "Onu dinle ve politikalarında yumuşamaya git.",
                        set: { guc_puani: 'it -15', halk_memnuniyeti: 'it +10', kisisel_vicdan: 'it +15' },
                        characterUpdate: { elif: { iliski: 'sadık' } },
                        nextNode: 'ilk_muhalif_sesler'
                    },
                    {
                        text: "Onu görevlendir. Eleştirilerini sistem içinde yapsın.",
                        set: { adalet_puani: 'it +10', kisisel_vicdan: 'it +5' },
                        characterUpdate: { elif: { iliski: 'sadık' } },
                        nextNode: 'ilk_muhalif_sesler'
                    }
                ]
            },
            // === BÖLÜM 2.4: İLK MUHALİF SESLER ===
            'ilk_muhalif_sesler': {
                text: "Bir grup genç, senin zamanında kullandığın yöntemlerle protestolara başlıyor.\n\nAdları: 'Gerçek Eşitler'.\n\nTalepleri: Senin verdiğin ama tutamadığın vaatler.\n\nBu yeni isyan kıvılcımına ne yapacaksın?",
                background: "BGs/tordah_Crowded_youth_rally_new_voices_rising_chanting_youth_e_3a6f606f-1171-4cb1-98d3-092092e2055d_0.png",
                choices: [
                    {
                        text: "Güvenlik güçlerini gönder - Tıpkı eskiler gibi",
                        set: { isyan_riski: 'it +25', halk_memnuniyeti: 'it -20' },
                        nextNode: 'gucun_yalnizligi'
                    },
                    {
                        text: "Liderleriyle görüş - Onları sisteme dahil et",
                        set: { hazine: 'it -15', adalet_puani: 'it +10' },
                        nextNode: 'gucun_yalnizligi'
                    },
                    {
                        text: "Kara propaganda - Onları 'eski rejim ajanı' olarak yaftala",
                        set: { guc_puani: 'it +15', isyan_riski: 'it +15' },
                        nextNode: 'gucun_yalnizligi'
                    }
                ]
            },
            // === BÖLÜM 2.5: GÜCÜN YALNIZLIĞI ===
            'gucun_yalnizligi': {
                text: "Artık ofisinde yalnızsın. Verdiğin kararlar seni ideallerinden uzaklaştırdı.\n\nÜlke ya bir polis devletine, ya iflasın eşiğine ya da sürekli isyanların olduğu bir kaosa sürüklendi.\n\nPencereden dışarı bakıyorsun.",
                background: "BGs/tordah_Silhouette_of_lone_leader_atop_a_throne_empty_hall_sol_ebce6dc9-2a84-41dd-b9d5-2e94430fb48f_3.png",
                choices: [
                    {
                        text: "Devam et",
                        nextNode: 'perde3_gecis'
                    }
                ]
            },
            // === BÖLÜM 3.0: GEÇİŞ - KRİZ DÖNEMİ ===
            'perde3_gecis': {
                text: "*** KRİZ DÖNEMİ ***\n\nAylar geçti ve durum kritik. Eski yoldaşların ya düşman ya da sessiz.\n\nHalk ya korkuyor ya da nefret ediyor. Yeni bir devrimci hareket ortaya çıktı.\n\nTek amaç: İsyan riskini engellemek ve iktidarı korumak.",
                background: "BGs/tordah_Abandoned_council_chamber_dust_settles_decision_made_i_a06994f3-fb38-4759-8417-c990be01ef78_1.png",
                choices: [
                    {
                        text: "Devam et",
                        nextNode: 'golgedeki_lider'
                    }
                ]
            },
            // === BÖLÜM 3.1: GÖLGEDEKİ LİDER ===
            'golgedeki_lider': {
                text: "İstihbarat şefin, yeni devrimci hareket 'Gerçek Eşitler' hakkında bir rapor sunuyor.\n\nBaşlarında karizmatik ve idealist yeni bir lider var. Tıpkı senin gençliğin gibi.\n\nTehdidi nasıl ortadan kaldırırsın?",
                background: "BGs/tordah_Intelligence_officers_around_war_room_table_watching_m_044fc08f-20f9-4c41-9c07-d9c52851a561_1.png",
                choices: [
                    {
                        text: "Tutuklama - Komplo suçlamasıyla lideri hapse at",
                        set: { isyan_riski: 'it +20' },
                        nextNode: 'kirilma_noktasi'
                    },
                    {
                        text: "Suikast - Sessizce ve gizlice ortadan kaldır",
                        set: { guc_puani: 'it +25', adalet_puani: 'it -20', isyan_riski: 'it -10' },
                        nextNode: 'kirilma_noktasi'
                    },
                    {
                        text: "İtibarsızlaştırma - Hakkında sahte kanıtlar üret",
                        set: { isyan_riski: 'it +10' },
                        nextNode: 'kirilma_noktasi'
                    }
                ]
            },
            // === BÖLÜM 3.2: KIRILMA NOKTASI ===
            'kirilma_noktasi': {
                text: "Yaptığın hamleye tepki olarak ülke genelinde büyük bir protesto dalgası başlıyor.\n\nBu, senin devriminden bile büyük olabilir.\n\nAna meydan, senin zamanında yaptığın gibi, isyancılar tarafından doldurulmuş.\n\nBu kaos ortamında, Zertan İmparatorluğu 'istikrarı sağlamak' bahanesiyle ülkeyi işgal etme tehdidinde bulunuyor.\n\nNe yapacaksın?",
                background: "BGs/tordah_Massive_crowds_clashing_with_security_forces_in_broad__dfe36c06-d7cb-4158-8a64-31c91cff65ee_0.png",
                choices: [
                    {
                        text: "Tam baskı - Orduyu sokağa indir, sıkıyönetim ilan et",
                        set: { halk_memnuniyeti: 'it -30', isyan_riski: 'it +30' },
                        nextNode: 'final_ic_savas'
                    },
                    {
                        text: "Taviz - Tüm taleplerini kabul et, erken seçime git",
                        set: { adalet_puani: 'it +20', halk_memnuniyeti: 'it +15' },
                        nextNode: 'final_onurlu_son'
                    },
                    {
                        text: "Gözdağı - Güç gösterisi yap ama ateş açma emri verme",
                        set: { guc_puani: 'it +15', isyan_riski: 'it +15' },
                        nextNode: 'final_devrilme'
                    },
                    {
                        text: "Ulusal birlik - 'Gerçek Eşitler'le birleş, dış tehdide karşı diren",
                        set: { adalet_puani: 'it +25', halk_destegi: 'it +20', kisisel_vicdan: 'it +15' },
                        nextNode: 'final_ulusal_birlik'
                    },
                    {
                        text: "Zertan'dan yardım iste - İsyanı bastır ama kukla ol",
                        set: { guc_puani: 'it +30', kisisel_vicdan: 'it -25', dis_politika_durumu: 'savaşta' },
                        nextNode: 'final_kukla_lider'
                    },
                    {
                        text: "Kaçış - Gizlice ülkeyi terk et",
                        set: { adalet_puani: 'it -15', guc_puani: 'it -15', halk_destegi: 'it -20' },
                        nextNode: 'final_surgun'
                    }
                ]
            },
            // === FİNAL SONLAR ===
            'final_ic_savas': {
                text: "Ülke iç savaşa sürükleniyor. Kaotik bir harita ekranıyla oyun bitiyor.\n\nYIKIM.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Fragmented_nation_map_overlaid_with_conflict_zones_cha_5a487c4e-59db-4c7e-b0a4-bbf4baaae37b_1.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            },
            'final_onurlu_son': {
                text: "İktidarı barışçıl yolla devrediyorsun. Tarihe hem bir devrimci hem de bir tiran olarak geçiyorsun.\n\nİRONİ.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Crowds_celebrating_peaceful_handover_of_power_in_publi_02cf515a-4164-434d-b8ec-653e28ac9495_0.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            },
            'final_devrilme': {
                text: "Ordu sana ihanet ediyor veya isyancılar Saray'ı basıyor. Tıpkı senin devirdiğin lider gibi yakalanıyorsun.\n\nDÖNGÜ TAMAMLANDI.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Storming_of_palace_by_rebel_forces_banners_raised_mili_09bec77e-2ae3-423c-96ad-4d4e71bab268_1.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            },
            'final_surgun': {
                text: "Başka bir ülkede, haberlerden kendi devrilmeni izliyorsun.\n\nYALNIZLIK.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Exiled_leader_watching_homeland_on_news_screen_distant_5b13570b-163f-4000-952c-1f5257b93931_1.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            },
            'final_ulusal_birlik': {
                text: "Ulusal birlik hükümeti kurdun. 'Gerçek Eşitler'le birleşerek dış tehdide karşı direndin.\n\nGücünü paylaştın ama ülkeyi kurtardın.\n\nBİRLİK.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Coalition_government_assembly_in_national_hall_diverse_f2f84f89-9242-42e8-aef3-a9a43db0168d_2.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            },
            'final_kukla_lider': {
                text: "Zertan'dan yardım istedin. İsyanı bastırdın ama ülkeyi bir kukla devlete dönüştürdün.\n\nArtık Zertan'ın kontrolündesin.\n\nİHANET.\n\nDöngü tamamlandı, {karakter_adi}.\n\nPuanların:\nAdalet: {adalet_puani}\nGüç: {guc_puani}\nHalk Desteği: {halk_destegi}\nHalk Memnuniyeti: {halk_memnuniyeti}\nİsyan Riski: {isyan_riski}\nHazine: {hazine}\nKişisel Vicdan: {kisisel_vicdan}",
                background: "BGs/tordah_Puppet_government_ceremony_with_marionette_imagery_for_94e4a9cc-70b1-4632-a04e-6e20e3dc0b52_1.png",
                choices: [
                    {
                        text: "Yeniden Oyna",
                        nextNode: 'start'
                    }
                ]
            }
        };

        // === EVENT LISTENER'LAR ===
        
        // İlişkiler paneli toggle
        document.getElementById('relationships-toggle').addEventListener('click', () => {
            const panel = document.getElementById('relationships-panel');
            panel.classList.toggle('show');
        });
        
        // Kontrol paneli event listener'ları
        document.getElementById('save-button').addEventListener('click', () => {
            saveGameState();
        });
        
        document.getElementById('load-button').addEventListener('click', () => {
            if (loadGameState()) {
                showNode('start');
            } else {
                showNotification('Kayıtlı oyun bulunamadı!', 'error');
            }
        });
        
        document.getElementById('reset-button').addEventListener('click', () => {
            if (confirm('Oyunu sıfırlamak istediğinizden emin misiniz?')) {
                localStorage.removeItem('theEquals_save');
                location.reload();
            }
        });
        
        // Lore tooltip için event listener
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('lore-term')) {
                const term = e.target.textContent;
                const tooltips = {
                    'Zertan İmparatorluğu': 'Komşu güçlü imparatorluk. Devrimden endişeleniyor.',
                    'Eski Rejim': 'Devirdiğiniz eski yönetim sistemi.',
                    'Elitler': 'Zengin ve güçlü sınıf. Devrimden önce iktidardaydılar.',
                    'Gerçek Eşitler': 'Yeni devrimci hareket. Sizin verdiğiniz vaatleri istiyorlar.'
                };
                
                if (tooltips[term]) {
                    showLoreTooltip(tooltips[term], e.pageX, e.pageY);
                }
            } else {
                hideLoreTooltip();
            }
        });
        
        // Oyunu başlat
        startGame();

    </script>

</body>
</html>
